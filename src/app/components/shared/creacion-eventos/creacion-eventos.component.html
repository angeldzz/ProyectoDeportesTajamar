<div class="creacion-eventos-container">
    <div class="header">
        <h1 class="title">Crear Nuevo Evento</h1>
        <p class="subtitle">Selecciona una fecha en el calendario para crear un evento</p>
    </div>

    <div class="content-wrapper">
        <!-- Informaci贸n de fecha seleccionada -->
        <div class="selected-date-info">
            @if (selectedDate) {
                <div class="date-selected">
                    <i class="bi bi-calendar-check"></i>
                    <div class="date-details">
                        <span class="label">Fecha seleccionada:</span>
                        <span class="date-value">{{ selectedDateStr }}</span>
                    </div>
                </div>
            } @else {
                <div class="date-placeholder">
                    <i class="bi bi-calendar-event"></i>
                    <span>Haz clic en una fecha del calendario para seleccionarla</span>
                </div>
            }
        </div>

        <!-- Calendario -->
        <div class="calendar-wrapper">
            <full-calendar [options]="calendarOptions"></full-calendar>
        </div>

        <!-- Bot贸n de acci贸n -->
        <div class="action-buttons">
            <button
                type="button"
                class="btn btn-crear-evento"
                (click)="crearEvento()"
                [disabled]="!selectedDate">
                <i class="bi bi-plus-circle"></i>
                Crear Evento
            </button>
        </div>
    </div>
</div>

<!-- Modal de selecci贸n de hora estilo iPhone -->
@if (showTimeModal) {
    <div class="time-modal-overlay" (click)="closeTimeModal()">
        <div class="time-modal-content" (click)="$event.stopPropagation()">
            <div class="time-modal-header">
                <h3>Seleccionar Hora</h3>
                <button class="close-btn" (click)="closeTimeModal()">
                    <i class="bi bi-x"></i>
                </button>
            </div>

            <div class="time-modal-body">
                <div class="date-display">
                    <i class="bi bi-calendar3"></i>
                    <span>{{ selectedDateStr }}</span>
                </div>

              <div class="profesor-selector-container mb-4">
                <label class="form-label fw-bold small text-muted text-uppercase d-block mb-2">
                  Responsable del Evento
                </label>
                <select class="form-select bg-light border-0" [(ngModel)]="idProfesorSeleccionado">
                  <option [ngValue]="null" disabled selected>Seleccionar Profesor...</option>
                  @for (profe of profesores; track profe.idUsuario) {
                    <option [ngValue]="profe.idUsuario">
                      {{ profe.usuario }} {{ profe.apellidos }}
                    </option>
                  }
                </select>
              </div>

                <div class="time-picker-container">
                    <div class="time-picker-overlay-top"></div>
                    <div class="time-picker-selection-indicator"></div>
                    <div class="time-picker-overlay-bottom"></div>

                    <div class="time-picker-column">
                        <div class="time-picker-scroll"
                             (scroll)="onHourScroll($event)"
                             (mousedown)="onHourMouseDown($event)"
                             (mousemove)="onHourMouseMove($event)"
                             (mouseup)="onHourMouseUp()"
                             (mouseleave)="onHourMouseUp()">
                            <div class="time-picker-spacer"></div>
                            @for (hour of hours; track hour) {
                                <div class="time-picker-item"
                                     [class.selected]="hour === selectedHour">
                                    {{ hour.toString().padStart(2, '0') }}
                                </div>
                            }
                            <div class="time-picker-spacer"></div>
                        </div>
                        <div class="time-picker-label">horas</div>
                    </div>

                    <div class="time-picker-separator">:</div>

                    <div class="time-picker-column">
                        <div class="time-picker-scroll"
                             (scroll)="onMinuteScroll($event)"
                             (mousedown)="onMinuteMouseDown($event)"
                             (mousemove)="onMinuteMouseMove($event)"
                             (mouseup)="onMinuteMouseUp()"
                             (mouseleave)="onMinuteMouseUp()">
                            <div class="time-picker-spacer"></div>
                            @for (minute of minutes; track minute) {
                                <div class="time-picker-item"
                                     [class.selected]="minute === selectedMinute">
                                    {{ minute.toString().padStart(2, '0') }}
                                </div>
                            }
                            <div class="time-picker-spacer"></div>
                        </div>
                        <div class="time-picker-label">minutos</div>
                    </div>
                </div>
            </div>

            <div class="time-modal-footer">
                <button class="btn-cancel" (click)="closeTimeModal()">
                    Cancelar
                </button>
                <button class="btn-confirm" (click)="confirmTime()">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
}
